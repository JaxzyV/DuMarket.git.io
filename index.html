<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Du Market - Toko Online SMK Negeri Darul Ulum Muncar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" class="rounded-full" href="smk.jpg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/feather-icons"></script>

    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f0f8ff; /* Alice Blue - a very light sky blue */
      }
      .page {
        display: none;
      }
      .page.active {
        display: block;
      }
      .logo-font {
        font-weight: 700;
        letter-spacing: -0.5px;
      }
      .btn-primary {
        @apply bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-sky-600 transition-all duration-300;
      }
      .btn-secondary {
        @apply bg-blue-800 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-blue-900 transition-all duration-300;
      }
      /* Custom scrollbar for a better look */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
    </style>
  </head>
  <body class="text-gray-800">
    <!-- Header & Navigasi -->
    <header class="bg-blue-400 shadow-md sticky top-0 z-50">
      <div class="mx-auto px-4 py-3 flex justify-between items-center">
        <div class="flex gap-2">
          <img src="Asset1/smk.jpg" class="w-12 h-12 rounded-full" alt="" />
          <a
            href="#"
            class="nav-link text-3xl logo-font text-blue-800"
            data-page="beranda"
            >Du<span class="text-white">Market</span></a
          >
        </div>
        <nav class="hidden md:flex items-center space-x-6"></nav>
        <div class="flex items-center space-x-4">
          <a
            href="https://www.instagram.com/smkndarululummuncar?igsh=MWp1M2ptZzNyaTRmeA=="
            target="_blank"
            class="text-gray-600 hover:text-sky-500"
          >
            <img
              src="Asset1/Instagram.png"
              class="w-7 h-7 cursor-pointer hover:scale-110 transition duration-300"
              alt="instagram"
          /></a>
          <a
            href="https://www.tiktok.com/@mediasmkndarululum?_r=1&_t=ZS-91t5JkVm60C"
            target="_blank"
            class="text-gray-600 hover:text-sky-500"
            ><img
              id="img-tiktok"
              src="Asset1/Tiktok.png"
              class="w-7 h-7 cursor-pointer hover:scale-110 transition duration-300"
              alt="Tiktok"
          /></a>
          <button id="mobile-menu-button" class="md:hidden">
            <i data-feather="menu"></i>
          </button>
        </div>
      </div>
      <!-- Mobile Menu -->
      <div id="mobile-menu" class="hidden md:hidden bg-white py-2">
        <a
          href="#"
          class="nav-link block px-4 py-2 text-gray-600 hover:bg-sky-100"
          data-page="produk"
          >Produk</a
        >
        <a
          href="#"
          class="nav-link block px-4 py-2 text-gray-600 hover:bg-sky-100"
          data-page="testimoni"
          >Testimoni</a
        >
        <a
          href="#"
          class="nav-link block px-4 py-2 text-gray-600 hover:bg-sky-100"
          data-page="promo"
          >Promo</a
        >
      </div>
    </header>

    <main class="container mx-auto p-4 md:p-6">
      <!-- Halaman Beranda -->
      <section id="beranda" class="page active">
        <div
          class="bg-gradient-to-r from-sky-400 to-blue-600 rounded-xl p-8 md:p-16 text-white text-center shadow-lg"
        >
          <h1 class="text-4xl md:text-5xl font-bold mb-4">
            Selamat Datang di <span class="text-blue-700">Du</span>Market!
          </h1>
          <p class="text-lg md:text-xl mb-8">
            Temukan Berbagai Produk dan Layanan Terbaik Dari DuMarket
          </p>
          <button
            class="btn-secondary underline text-lg nav-link hover:font-bold hover:text-blue-600 hover:underline"
            data-page="produk"
          >
            Lihat Semua Produk
          </button>
        </div>
        <div class="mt-8 text-center">
          <h2 class="text-2xl font-bold text-blue-800 mb-4">
            Produk & Jasa Unggulan Kami
          </h2>
          <div
            id="unggulan-grid"
            class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"
          >
            <!-- Produk unggulan akan diisi oleh JS -->
          </div>
        </div>
      </section>

      <!-- Halaman Produk -->
      <section id="produk" class="page">
        <h1 class="text-3xl font-bold mb-6 text-center text-blue-800">
          Katalog Produk & Jasa
        </h1>

        <!-- Filter dan Pencarian -->
        <div
          class="bg-white p-4 rounded-lg shadow-md mb-6 flex flex-col md:flex-row gap-4 items-center"
        >
          <div class="relative flex-grow w-full">
            <input
              type="text"
              id="search-input"
              placeholder="Cari produk..."
              class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500"
            />
            <div
              class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
            >
              <i data-feather="search" class="text-gray-400"></i>
            </div>
          </div>
          <div class="flex gap-4 w-full md:w-auto">
            <select
              id="filter-kategori"
              class="w-full md:w-auto border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500"
            >
              <option value="all">Semua Kategori</option>
              <option value="Produk">Produk</option>
              <option value="Jasa">Jasa</option>
            </select>
            <select
              id="filter-harga"
              class="w-full md:w-auto border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500"
            >
              <option value="all">Semua Harga</option>
              <option value="low">Terendah - Tertinggi</option>
              <option value="high">Tertinggi - Terendah</option>
            </select>
            <select
              id="filter-ukuran"
              class="w-full md:w-auto border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500"
            >
              <option value="all">Semua Ukuran</option>
              <option value="Kecil">Kecil</option>
              <option value="Sedang">Sedang</option>
              <option value="Besar">Besar</option>
            </select>
          </div>
        </div>

        <!-- Grid Produk -->
        <div
          id="product-grid"
          class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6"
        >
          <!-- Produk akan diisi oleh JS -->
        </div>
        <p id="no-product-found" class="text-center text-gray-500 mt-8 hidden">
          Oops! Produk yang kamu cari tidak ditemukan.
        </p>
      </section>

      <!-- Halaman Detail Produk -->
      <section id="detail-produk" class="page"></section>

      <!-- Halaman Testimoni -->
      <section id="testimoni" class="page">
        <h1 class="text-3xl font-bold mb-8 text-center text-blue-800">
          Apa Kata Mereka?
        </h1>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Testimoni 1 -->
          <div class="bg-white p-6 rounded-lg shadow-lg">
            <p class="text-gray-600 mb-4">
              "Desain keychain-nya lucu banget! Pengiriman juga cepat. Suka
              banget sama HSJmArket!"
            </p>
            <div class="flex items-center">
              <img
                src="https://placehold.co/40x40/a0e9ff/333333?text=A"
                alt="Avatar"
                class="w-10 h-10 rounded-full mr-4"
              />
              <div>
                <p class="font-semibold">Andini Putri</p>
                <p class="text-sm text-gray-500">Pembeli Keychain</p>
              </div>
            </div>
          </div>
          <!-- Testimoni 2 -->
          <div class="bg-white p-6 rounded-lg shadow-lg">
            <p class="text-gray-600 mb-4">
              "Tumbler-nya kualitasnya oke punya, desainnya juga
              anti-mainstream. Jadi semangat bawa minum sendiri."
            </p>
            <div class="flex items-center">
              <img
                src="https://placehold.co/40x40/4e78c4/ffffff?text=B"
                alt="Avatar"
                class="w-10 h-10 rounded-full mr-4"
              />
              <div>
                <p class="font-semibold">Budi Santoso</p>
                <p class="text-sm text-gray-500">Pembeli Tumbler</p>
              </div>
            </div>
          </div>
          <!-- Testimoni 3 -->
          <div class="bg-white p-6 rounded-lg shadow-lg">
            <p class="text-gray-600 mb-4">
              "Totebag-nya muat banyak dan bahannya kuat. Udah jadi tas andalan
              buat kuliah sekarang. Thank you!"
            </p>
            <div class="flex items-center">
              <img
                src="https://placehold.co/40x40/a0e9ff/333333?text=C"
                alt="Avatar"
                class="w-10 h-10 rounded-full mr-4"
              />
              <div>
                <p class="font-semibold">Citra Lestari</p>
                <p class="text-sm text-gray-500">Pembeli Totebag</p>
              </div>
            </div>
          </div>
        </div>
        <div class="text-center mt-10">
          <a
            href="https://forms.gle/your-form-id"
            target="_blank"
            class="btn-primary inline-block"
            >Beri Ulasan Anda</a
          >
        </div>
      </section>

      <!-- Halaman Promo -->
      <section id="promo" class="page">
        <div class="text-center bg-white p-8 rounded-xl shadow-lg">
          <img
            src="https://placehold.co/600x300/a0e9ff/0f172a?text=FLASH+SALE!"
            alt="Flash Sale"
            class="w-full max-w-lg mx-auto rounded-lg mb-6"
          />
          <h1 class="text-3xl font-bold text-blue-800">
            Promo Spesial Bulan Ini!
          </h1>
          <p class="text-gray-600 mt-2 mb-6">
            Jangan lewatkan kesempatan emas! Dapatkan diskon hingga 30% untuk
            produk pilihan.
          </p>
          <button class="btn-secondary nav-link" data-page="produk">
            Belanja Sekarang!
          </button>
        </div>
      </section>
    </main>

    <!-- Floating WhatsApp Button -->
    <a
      href="#"
      id="whatsapp-order-shortcut"
      class="fixed bottom-6 right-6 bg-green-500 text-white p-4 rounded-full shadow-lg hover:bg-green-600 transition-transform transform hover:scale-110"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="28"
        height="28"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="feather feather-message-circle"
      >
        <path
          d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"
        ></path>
      </svg>
    </a>

    <!-- Confirmation Modal -->
    <div
      id="confirmation-modal"
      class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 hidden p-4"
    >
      <div
        class="bg-white rounded-lg w-full max-w-md shadow-xl overflow-hidden"
      >
        <h2 class="text-xl font-bold text-white bg-blue-800 p-4 text-center">
          Konfirmasi Pesanan
        </h2>
        <div class="p-6">
          <div class="space-y-3 text-gray-700">
            <p>
              <strong>Nama Produk:</strong>
              <span id="modal-product-name"></span>
            </p>
            <p>
              <strong>Harga Satuan:</strong> <span id="modal-unit-price"></span>
            </p>
            <p><strong>Jumlah:</strong> <span id="modal-quantity"></span></p>
            <hr class="my-3" />
            <p class="text-lg font-semibold">
              <strong>Total Harga:</strong>
              <span id="modal-total-price" class="text-sky-600"></span>
            </p>
          </div>
          <div class="mt-6 flex justify-end gap-3">
            <button
              id="modal-cancel-btn"
              class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 transition-all"
            >
              Batal
            </button>
            <button id="modal-confirm-btn" class="btn-primary">
              Lanjut ke WhatsApp
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-blue-800 text-white mt-12">
      <div class="container mx-auto p-6 text-center">
        <p>&copy; 2025 DuMarket. SMK Negeri Darul Ulum Muncar</p>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        let currentOrderDetails = {};

        // --- DATABASE PRODUK ---
        const products = [
          {
            id: 1,
            name: " Custom Pembuatan Kapal Fiber",
            category: "Jasa",
            price: 5000000,
            size: "Sedang",
            description:
              "Custom Pembuatan Kapal Fiber dengan desain khusus, tampil beda dan stylish dengan harga bervariasi.",
            image: "Asset1/TKPI_Kapal.jpeg",
          },
          {
            id: 2,
            name: " Custom Pengelasan Logam",
            category: "Jasa",
            price: 150000,
            size: "Sedang",
            description:
              "Pengelasan Logam dengan desain khusus, tampil beda dan stylish dengan harga bervariasi.",
            image: "Asset1/TKPI_Pengelasan.jpeg",
          },
          {
            id: 3,
            name: "Jasa Service Mobil",
            category: "Jasa",
            price: 150000,
            size: "Sedang",
            description: "Jasa service mobil dengan layanan terbaik.",
            image: "Asset1/TO_Mobil.jpeg",
          },
          {
            id: 4,
            name: "Oli Dan Suku Cadang Mobil",
            category: "Produk",
            price: 190000,
            size: "Sedang",
            description:
              "Penjualan oli dan suku cadang mobil dengan kualitas terbaik.",
            image: "Asset1/TO_Sperpart.jpeg",
          },
          {
            id: 5,
            name: "Sarden",
            category: "Produk",
            price: 10000,
            size: "Sedang",
            description:
              "Sarden yang terbuat dari olahan ikan berkualitas dan diolah dengan teknologi modern.",
            image: "Asset1/APHP_Sarden.jpeg",
          },
          {
            id: 6,
            name: "Jasa Jahit Pakaian",
            category: "Jasa",
            price: 50000,
            size: "Sedang",
            description:
              "Jasa jahit pakaian dengan berbagai model yang menarik, serta denga harga terjangkau.",
            image: "Asset1/DPB_Jahit.jpeg",
          },
          {
            id: 7,
            name: "Langganan Website UMKM",
            category: "Produk",
            price: 50000,
            size: "Sedang",
            description:
              "Langganan website untuk UMKM dengan fitur khusus dan harga terjangkau.",
            image: "Asset1/AKL_Umkm.jpeg",
          },
          {
            id: 8,
            name: "Jasa Dokumentasi",
            category: "Jasa",
            price: 800000,
            size: "Sedang",
            description:
              "Jasa dokumentasi dengan kualitas terbaik serta tema yang kreatif.",
            image: "Asset1/DKV_shoting.jpeg",
          },
          {
            id: 9,
            name: "Jasa Service Komputer",
            category: "Jasa",
            price: 45000,
            size: "Sedang",
            description:
              "Mengatasi berbagai kendala yang terjadi pada komputer anda, dengan harga terjangkau.",
            image: "Asset1/TJKT_Komputer.jpeg",
          },
          {
            id: 10,
            name: "Frozen Food",
            category: "Produk",
            price: 30000,
            size: "Sedang",
            description:
              "Penjualan frozen food dengan kualitas terbaik serta harga ramah dikantong.",
            image: "Asset1/APHP_SeaFood.jpeg",
          },
        ];

        const NOMOR_WHATSAPP = "6285162724688"; // nomor WhatsApp

        // --- DOM ELEMENTS ---
        const pages = document.querySelectorAll(".page");
        const navLinks = document.querySelectorAll(".nav-link");
        const productGrid = document.getElementById("product-grid");
        const unggulanGrid = document.getElementById("unggulan-grid");
        const detailProdukContainer = document.getElementById("detail-produk");
        const searchInput = document.getElementById("search-input");
        const filterKategori = document.getElementById("filter-kategori");
        const filterHarga = document.getElementById("filter-harga");
        const filterUkuran = document.getElementById("filter-ukuran");
        const noProductFound = document.getElementById("no-product-found");
        const mobileMenuButton = document.getElementById("mobile-menu-button");
        const mobileMenu = document.getElementById("mobile-menu");
        const whatsappShortcut = document.getElementById(
          "whatsapp-order-shortcut"
        );
        const modal = document.getElementById("confirmation-modal");
        const modalProductName = document.getElementById("modal-product-name");
        const modalUnitPrice = document.getElementById("modal-unit-price");
        const modalQuantity = document.getElementById("modal-quantity");
        const modalTotalPrice = document.getElementById("modal-total-price");
        const modalConfirmBtn = document.getElementById("modal-confirm-btn");
        const modalCancelBtn = document.getElementById("modal-cancel-btn");

        // --- FUNGSI ---

        // Fungsi untuk menampilkan halaman
        const showPage = (pageId, productId = null) => {
          pages.forEach((page) => page.classList.remove("active"));
          const targetPage = document.getElementById(pageId);
          if (targetPage) {
            targetPage.classList.add("active");
            if (pageId === "detail-produk" && productId) {
              renderProductDetail(productId);
            }
          }
          window.scrollTo(0, 0);
          mobileMenu.classList.add("hidden");
        };

        // Format Rupiah
        const formatRupiah = (number) => {
          return new Intl.NumberFormat("id-ID", {
            style: "currency",
            currency: "IDR",
            minimumFractionDigits: 0,
          }).format(number);
        };

        // Fungsi untuk merender semua produk ke grid
        const renderProducts = (productsToRender) => {
          productGrid.innerHTML = "";
          if (productsToRender.length === 0) {
            noProductFound.classList.remove("hidden");
          } else {
            noProductFound.classList.add("hidden");
          }
          productsToRender.forEach((product) => {
            const productCard = document.createElement("div");
            productCard.className =
              "bg-white rounded-lg shadow-md overflow-hidden group transform hover:-translate-y-1 transition-all duration-300 cursor-pointer";
            productCard.innerHTML = `
                        <div class="aspect-w-1 aspect-h-1 w-full overflow-hidden">
                            <img src="${product.image}" alt="${
              product.name
            }" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold truncate">${
                              product.name
                            }</h3>
                            <p class="text-sky-600 font-bold mt-1">${formatRupiah(
                              product.price
                            )}</p>
                        </div>
                    `;
            productCard.addEventListener("click", () =>
              showPage("detail-produk", product.id)
            );
            productGrid.appendChild(productCard);
          });
        };

        // Render produk unggulan di beranda
        const renderUnggulan = () => {
          const shuffled = [...products].sort(() => 0.5 - Math.random());
          const unggulanProducts = shuffled.slice(0, 4);
          unggulanGrid.innerHTML = "";
          unggulanProducts.forEach((product) => {
            const productCard = document.createElement("div");
            productCard.className =
              "bg-white rounded-lg shadow-md overflow-hidden group transform hover:-translate-y-1 transition-all duration-300 cursor-pointer";
            productCard.innerHTML = `
                        <div class="aspect-w-1 aspect-h-1 w-full overflow-hidden">
                            <img src="${product.image}" alt="${
              product.name
            }" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold truncate">${
                              product.name
                            }</h3>
                            <p class="text-sky-600 font-bold mt-1">${formatRupiah(
                              product.price
                            )}</p>
                        </div>
                    `;
            productCard.addEventListener("click", () =>
              showPage("detail-produk", product.id)
            );
            unggulanGrid.appendChild(productCard);
          });
        };

        // Fungsi untuk merender detail produk
        const renderProductDetail = (productId) => {
          const product = products.find((p) => p.id === productId);
          if (product) {
            detailProdukContainer.innerHTML = `
                        <div class="bg-white p-4 md:p-6 rounded-lg shadow-lg">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                                <div class="flex justify-center items-center">
                                    <img src="${product.image}" alt="${
              product.name
            }" class="rounded-lg max-w-full h-auto shadow-md">
                                </div>
                                <div>
                                    <h1 class="text-2xl md:text-3xl font-bold text-blue-800">${
                                      product.name
                                    }</h1>
                                    <p class="text-xl md:text-2xl text-sky-600 font-bold my-3">${formatRupiah(
                                      product.price
                                    )}</p>
                                    <div class="space-x-2 mb-4">
                                        <span class="bg-sky-100 text-sky-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">${
                                          product.category
                                        }</span>
                                        <span class="bg-blue-100 text-blue-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">${
                                          product.size
                                        }</span>
                                    </div>
                                    <p class="text-gray-600 leading-relaxed mb-6">${
                                      product.description
                                    }</p>
                                    
                                    <div class="flex flex-col gap-4 mb-2">
                                        <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
                                            <label for="customer-name" class="font-semibold w-full sm:w-16">Nama:</label>
                                            <input type="text" id="customer-name" placeholder="Nama Anda" class="flex-grow border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500">
                                        </div>
                                        <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
                                            <label for="quantity" class="font-semibold w-full sm:w-16">Jumlah:</label>
                                            <input type="number" id="quantity" value="1" min="1" class="w-24 border rounded-lg p-2 text-center focus:outline-none focus:ring-2 focus:ring-sky-500">
                                        </div>
                                    </div>
                                    <p id="order-validation-msg" class="text-red-500 text-sm mt-2 h-5"></p>
                                    
                                    <div class="mt-2">
                                        <button id="order-button" class="btn-primary w-full text-lg flex items-center justify-center gap-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 4.315 1.731 6.096l-1.847 6.742 6.782-1.782zM13.832 12.12c-.271-.124-.89-.441-1.029-.492-.139-.052-.239-.078-.339.078-.1.156-.389.492-.479.591-.09.099-.18.125-.33.077-.149-.048-1.252-.462-2.387-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.139-.606.137-.133.307-.347.46-.52.153-.172.204-.297.304-.492.099-.196.05-.371-.025-.52-.075-.149-.339-.813-.465-.975-.125-.162-.25-.178-.339-.178-.089 0-.189-.006-.289-.006-.1 0-.26.042-.39.208-.13.166-.5.492-.5.839 0 .995.512 1.837 1.029 2.946.517 1.109 1.582 2.763 3.65 4.39.813.633 1.582 1.001 2.132 1.246.55.245 1.018.17 1.397-.087.419-.282.813-.913.913-1.139.099-.226.099-.413.049-.52z"/></svg>
                                            <span>Pesan via WhatsApp</span>
                                        </button>
                                        <p class="text-sm text-gray-500 mt-2 text-center">Sistem pemesanan adalah Pre-Order (PO).</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;

            document
              .getElementById("order-button")
              .addEventListener("click", () => {
                const quantityInput = document.getElementById("quantity");
                const customerNameInput =
                  document.getElementById("customer-name");
                const validationMsg = document.getElementById(
                  "order-validation-msg"
                );

                const quantity = parseInt(quantityInput.value);
                const customerName = customerNameInput.value.trim();

                if (!customerName) {
                  validationMsg.textContent =
                    "Mohon isi nama Anda terlebih dahulu.";
                  customerNameInput.focus();
                  customerNameInput.classList.add("ring-2", "ring-red-500");
                  return;
                }

                validationMsg.textContent = "";
                customerNameInput.classList.remove("ring-2", "ring-red-500");

                const totalPrice = product.price * quantity;

                currentOrderDetails = {
                  customerName: customerName,
                  productName: product.name,
                  quantity: quantity,
                  totalPrice: totalPrice,
                };

                // Populate and show modal
                modalProductName.textContent = product.name;
                modalUnitPrice.textContent = formatRupiah(product.price);
                modalQuantity.textContent = quantity;
                modalTotalPrice.textContent = formatRupiah(totalPrice);
                modal.classList.remove("hidden");
              });
          }
        };

        // Fungsi untuk memfilter dan mencari produk
        const filterAndSearchProducts = () => {
          const searchTerm = searchInput.value.toLowerCase();
          const category = filterKategori.value;
          const priceSort = filterHarga.value;
          const size = filterUkuran.value;

          let filteredProducts = products.filter((product) => {
            const matchesSearch = product.name
              .toLowerCase()
              .includes(searchTerm);
            const matchesCategory =
              category === "all" || product.category === category;
            const matchesSize = size === "all" || product.size === size;
            return matchesSearch && matchesCategory && matchesSize;
          });

          if (priceSort === "low") {
            filteredProducts.sort((a, b) => a.price - b.price);
          } else if (priceSort === "high") {
            filteredProducts.sort((a, b) => b.price - a.price);
          }

          renderProducts(filteredProducts);
        };

        // --- EVENT LISTENERS ---
        navLinks.forEach((link) => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            const pageId = link.getAttribute("data-page");
            showPage(pageId);
          });
        });

        [searchInput, filterKategori, filterHarga, filterUkuran].forEach(
          (element) => {
            element.addEventListener("input", filterAndSearchProducts);
            element.addEventListener("change", filterAndSearchProducts);
          }
        );

        mobileMenuButton.addEventListener("click", () => {
          mobileMenu.classList.toggle("hidden");
        });

        whatsappShortcut.addEventListener("click", (e) => {
          e.preventDefault();
          const message = `Halo DuMarket, saya ingin bertanya tentang produk Anda.`;
          const whatsappUrl = `https://api.whatsapp.com/send?phone=${NOMOR_WHATSAPP}&text=${message}`;
          window.open(whatsappUrl, "_blank");
        });

        modalCancelBtn.addEventListener("click", () => {
          modal.classList.add("hidden");
        });

        modalConfirmBtn.addEventListener("click", () => {
          const { customerName, productName, quantity, totalPrice } =
            currentOrderDetails;
          const message = `Halo DuMarket, perkenalkan nama saya *${customerName}*.%0A%0ASaya ingin mengkonfirmasi pesanan:%0A- Produk: *${productName}*%0A- Jumlah: *${quantity}*%0A- Total Harga: *${formatRupiah(
            totalPrice
          )}*%0A%0A(Ini adalah sistem Pre-Order)`;
          const whatsappUrl = `https://api.whatsapp.com/send?phone=${NOMOR_WHATSAPP}&text=${message}`;
          window.open(whatsappUrl, "_blank");
          modal.classList.add("hidden");
        });

        // --- INISIALISASI ---
        renderProducts(products);
        renderUnggulan();
        feather.replace();
        showPage("beranda");
      });
    </script>
  </body>
</html>
